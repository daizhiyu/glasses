<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <link rel="stylesheet" href="./css/main.css" />
    <script type="text/javascript" src="./js/index.js"></script>
    <title>放大镜</title>
    <script type="text/javascript">
        window.onload = function(){
            var preview = document.getElementById('preview');
            var big = document.getElementById('img-big');
            var bigImg = big.getElementsByTagName('img')[0];
            var medium = document.getElementById('img-medium');
            var mediumImg = medium.getElementsByTagName('img')[0];
            var mark = document.getElementById('mark');
            var detail = document.getElementById('detail');

            medium.onmouseover = function(){
                mark.style.display = "block";
                big.style.display = "block";
            }
            medium.onmouseout = function(){
                mark.style.display = "none";
                big.style.display = "none";
            }

            medium.onmousemove = function(e){
                var e = e || window.event;
                var left = e.clientX - preview.offsetLeft-mark.offsetWidth/2;
                var top = e.clientY - preview.offsetTop-mark.offsetHeight/2;

                if(left<0){
                    left = 0;
                }else if(left > this.offsetWidth - mark.offsetWidth){
                    left = this.offsetWidth - mark.offsetWidth;
                }

                if(top<0){
                    top = 0;
                }else if(top > this.offsetHeight - mark.offsetHeight){
                    top = this.offsetHeight - mark.offsetHeight;
                }
                mark.style.left = left+'px';
                mark.style.top = top+'px';

                persentX = left/(this.offsetWidth - mark.offsetWidth);
                persentY = top/(this.offsetHeight - mark.offsetHeight);
                // alert(persentX+'---'+persentY);
                detail.style.left = -persentX*400+'px';
                detail.style.top = -persentY*400+'px';
            }

            //小图导航
            var imgItems = document.getElementById('img-items');
            var liNodes = imgItems.childNodes;
            var tmpNodes = [];
            for(var i=0;i<liNodes.length;i++){
                if(liNodes[i].nodeType == 3) continue;
                tmpNodes.push(liNodes[i]);
            }
            var liNum = tmpNodes.length;
            var liWidth = parseInt(getCurrentStyle(tmpNodes[0])["width"]);//获取每个li的width值
            // alert(tmpNodes[0]);return;
            var liNo1 = tmpNodes[0].getElementsByTagName('img')[0];
            liNo1.style.border= "2px solid #e4393c";
            liNo1.style.width = "52px";
            liNo1.style.height = "52px";
            imgItems.style.width = liWidth*liNum+'px';
            for(var j=0;j<liNum;j++){
                tmpNodes[j].index = j;
                tmpNodes[j].onmouseover = function(){
                    var img = this.getElementsByTagName('img')[0];
                    // alert(this.index);
                    img.style.border = "2px solid #e4393c";
                    img.style.width = "52px";
                    img.style.height = "52px";
                    var _this = this;
                    for(var k=0;k<liNum;k++){
                        if(k != _this.index){
                            var imgI = tmpNodes[k].getElementsByTagName('img')[0];
                            imgI.style.border = "1px solid #abcdef";
                            imgI.style.width = "54px";
                            imgI.style.height = "54px";     
                        }
                    }
                    mediumImg.setAttribute('src',img.getAttribute('msrc'));
                    bigImg.setAttribute('src',img.getAttribute('bsrc'));
                }

            }

            //导航左右按钮
            var totalWidth = liWidth*liNum;
            var mWidth = totalWidth - liWidth*5;
            var lBtn = document.getElementById('left');
            var rBtn = document.getElementById('right');
            if(mWidth){
                // var step = 0;
                rBtn.onclick = function(){
                    // alert(getCurrentStyle(imgItems)['left']);return;
                    var timeId = setInterval(function(){
                        imgItems.style.left = (parseInt(getCurrentStyle(imgItems)["left"])-1)+'px';
                        if(getCurrentStyle(imgItems)["left"] == '-62px'){
                            clearInterval(timeId);
                        }
                    },10);


                }

            }else{
                alert('2');
            }


            //获取style样式兼容
            function getCurrentStyle(node) {
                return window.getComputedStyle ? window.getComputedStyle(node,null):node.correntStyle;
            }



        }
    </script>
</head>
<body>
<div class="fdj-wrap">
    <div id="preview">
        <div id="img-medium">
            <img src="images/01-zhongtu.jpg" alt="" width="350" height="350" />
            <div id="mark"></div>             
        </div>
        <!-- 小图导航开始 -->
        <div class="img-small">
            <a href="javascript:;" class="left" id="left">&lt</a>
            <a href="javascript:;" class="right" id="right">&gt</a>
            <div class="img-list-items">
                <ul id="img-items">
                    <li><img src="images/01.jpg" msrc="images/01-zhongtu.jpg" bsrc="images/01-datu.jpg" alt="" /></li>
                    <li><img src="images/02.jpg" msrc="images/02-zhongtu.jpg" bsrc="images/02-datu.jpg" alt="" /></li>
                    <li><img src="images/03.jpg" msrc="images/03-zhongtu.jpg" bsrc="images/03-datu.jpg" alt="" /></li>
                    <li><img src="images/04.jpg" msrc="images/04-zhongtu.jpg" bsrc="images/04-datu.jpg" alt="" /></li>
                    <li><img src="images/05.jpg" msrc="images/05-zhongtu.jpg" bsrc="images/05-datu.jpg" alt="" /></li>
                    <li><img src="images/06.jpg" msrc="images/06-zhongtu.jpg" bsrc="images/06-datu.jpg" alt="" /></li>
                </ul>   
            </div>
        </div>
        <!-- 小图导航结束 -->
        <div id="img-big">
            <img src="images/01-datu.jpg" alt="" id="detail" />
        </div>  
    </div>   
</div>



<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
<br />    
</body>
</html>